{%- for docset in collections.docsets -%}
  {%- if docset.data.doctree == key %}{% assign search_index = "search_index.json" | prepend: docset.url | prepend: site.baseurl %}{% endif -%}
{%- endfor -%}

<div x-data="searchApp({ baseurl: '{{ site.baseurl }}'})" x-init="loadIndex('{{ search_index }}')" x-on:keydown.slash.window="slashKeyPress">
    <form>
        <div>
            <input type="textbox" x-model="q" x-ref="searchBox" x-on:keydown.escape="escKeyPress">
            <div>/</div>
        </div>
    </form>
    <div class="search-results">
        <ul>
            <template x-for="result in searchResults" x-bind:key="result">
                <li>
                    <a x-bind:href="config.baseurl + result.url">
                        <div class="result-title" x-text="result.title"></div>
                        <div class="result-preview" x-text="preview(result.body)"></div>
                    </a>
                </li>
            </template>
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/elasticlunr@0.9/elasticlunr.min.js" type="text/javascript"></script>
<script src="{{ "/assets/javascript/search.js" | prepend: site.baseurl }}" type="text/javascript"></script>
